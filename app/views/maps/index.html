<h1>Block Value</h1>


<div id="brush"></div>

<canvas class="map" width="2000" height="500"></canvas>

<div class="color-picker">
  <div class="red" data-color="red">
    <span>Concrete</span>
  </div>
  <div class="yellow active" data-color="yellow">
    <span>Setback</span>
  </div>
  <div class="green" data-color="green">
    <span>Building</span>
  </div>
  <div class="blue" data-color="blue">
    <span>Sidewalks</span>
  </div>
  <div class="black" data-color="black">
    <span>???</span>
  </div>

</div>

<div class="paintbrush-settings">
  <div class="brush-size">
    <label>Brush Size:</label>
    <input id="stroke-size" type="range" name="stroke-size" min="1" max="30" value="10" data-sizing="px">
  </div>
</div>




<script>

  var colors = document.querySelectorAll(".color-picker div")
  var mouseDown = false
  const canvas = document.querySelector('.map')
  const ctx = canvas.getContext('2d')
  // var img = new Image()
  // img.src = 'http://www.tricedesigns.com/wp-content/uploads/2012/01/brush2.png'
  let brushSize = 10
  ctx.lineJoin = ctx.lineCap = 'round'

  // canvas.width = window.innerWidth
  // canvas.height = window.innerHeight

  ctx.fillRect(0,0,10,10)
  ctx.fillStyle = "#ffff00"
  ctx.strokeStyle = "#ffff00"


  function drawShit() {
    if(!mouseDown) return;
    ctx.lineWidth = brushSize

    var isDrawing, points = []
    points.push({x: event.offsetX, y: event.offsetY})
    ctx.clearRect(0,0, 5, 5)

    // let x = event.offsetX
    // let y = event.offsetY
    ctx.globalAlpha = 0.3;

    // ctx.globalCompositeOperation = 'source-in'

    ctx.beginPath();
    ctx.moveTo(points[0].x, points[0].y)
    for (var i = 0; i < points.length; i++) {
      ctx.lineTo(points[i].x, points[i].y)
    }
    // ctx.lineTo(x, y)

    // ctx.fillRect(x, y, brushSize, brushSize)
    // console.log({
    //   x: x,
    //   y: y,
    // });
    ctx.stroke();
      // send this shit to server eventually

    moveBrush(event.offsetX, event.offsetY)
    // console.log(x, y);
  }


  function setColor(){
    var color = this.dataset.color
    ctx.fillStyle = color
    ctx.strokeStyle = color
    $('#brush').css('background-color', color)
    $('.color-picker div').removeClass('active')
    this.classList.add('active')
  }

  function setBrushSize() {
    brushSize = this.value
    $('#brush').css('width', this.value)
    $('#brush').css('height', this.value)
  }

  function moveBrush(x, y) {
    $('#brush').css('left', x)
    $('#brush').css('top', y)
  }

  $(function () {

    colors.forEach(picker => picker.addEventListener('click', setColor))

    $(".map").on('mousedown', function() {
        mouseDown = true
    })

    $(".map").on('mouseup', function() {
        mouseDown = false
    })

    $(".map").on('mouseout', function() {
        mouseDown = false
    })
    $(".map").on('mousemove', drawShit)

    $(".paintbrush-settings input").on('change', setBrushSize)
    $(".paintbrush-settings input").on('mousemove', setBrushSize)

    // $(".map").on('mousemove', moveBrush)

  })


</script>

<style>

  * {
    box-sizing: border-box;
    padding: 0;
    margin: 0;
    -webkit-user-select: none;  /* Chrome all / Safari all */
    -moz-user-select: none;     /* Firefox all */
    -ms-user-select: none;      /* IE 10+ */
    user-select: none;          /* Likely future */
  }

  body {
    font-family: "Helvetica Neue", "Helvetica", sans-serif;
  }

  .map {
    /*width: 2000;
    height: 500px;*/
    background-image:url('/assets/bg_golden_small.jpg');
    background-size: auto;
    cursor: crosshair;
  }

  .color-picker {
    width: 100%;
  }
  .color-picker div {
    /*padding: 2em;*/
    width: 100%;
    text-align: center;
    vertical-align: middle;
    height: 3em;
    margin-top: -5px;
    width: 20%;
    float: left;
    display: block;
    cursor: pointer;
    text-transform: uppercase;
  }

  .color-picker div:hover {
    opacity: 0.5;
  }

  .color-picker div span {
    color: #fff;
    font-size: 1.5em;
    text-shadow: 1px 1px 1px #000;
  }

  .color-picker div.red {
    background-color:red;
  }
  .color-picker div.yellow {
    background-color: yellow;
  }
  .color-picker div.green {
    background-color: green;
  }
  .color-picker div.blue {
    background-color: blue;
  }
  .color-picker div.black {
    background-color: black;
  }

  .color-picker div.active {
    font-weight: 800;
  }

  #brush {
    background-color: #ffff00;
    border-radius: 100%;
    width: 1em;
    height: 1em;
    position: fixed;
    top:10;
    left:20;
  }

  .paintbrush-settings {
    width: 100%;
  }

  .brush-size {
    color: grey;
    font-size: 2em;
    text-shadow: 1px 1px 1px #000;
    width: 20%;
    height: 20px;
  }

</style>
